# Имитационное моделирование поточной линии окончательной сборки авиалайнеров

Курсовая работа / НИРС по имитационному моделированию сборочного авиазавода.

## Описание проекта

Проект реализует **дискретно-событийную имитационную модель** поточной линии окончательной сборки авиалайнеров на основе библиотеки **SimPy**. Модель позволяет исследовать влияние различных конфигураций производственной системы (буферы между участками, параллельная обработка, гибкая рабочая сила) на ключевые показатели производительности.

## Структура проекта

```
project_root/
  src/
    __init__.py              # Инициализация пакета
    data.py                   # Исходные данные по операциям, участкам, типам самолетов
    model.py                  # Имитационная модель (классы, процессы)
    scenarios.py              # Различные сценарии экспериментов
    run_experiments.py        # Запуск серий экспериментов и сохранение результатов
    analysis.py               # Анализ результатов, построение графиков
  notebooks/                  # Jupyter notebooks (опционально)
  report/
    report.md                 # Текст курсовой работы (на русском)
    figures/                  # Сохраненные графики
    statistics.csv            # Сводная статистика по сценариям
  results/                    # Результаты экспериментов
    all_results.pkl          # Все результаты в формате pickle
    summary.csv              # Сводная таблица результатов
    *.pkl                    # Отдельные файлы для каждого эксперимента
  test_model.py              # Тестовый скрипт для проверки модели
  requirements.txt           # Зависимости проекта
  README.md                  # Этот файл
  QUICKSTART.md              # Краткая инструкция по запуску
```

## Что было реализовано

### 1. Модель данных (`src/data.py`)

**Классы и структуры данных:**
- `Operation` (dataclass) - представляет операцию на рабочем участке:
  - `name`: название операции
  - `station_id`: номер участка (1-5)
  - `sequence`: номер последовательности выполнения
  - `predecessors`: список операций-предшественников
  - `processing_time_by_type`: время выполнения для каждого типа самолета (SA101, SA102, SA103)
  - `mechanics_required`: количество механиков, необходимых для операции

**Константы и конфигурации:**
- `AIRCRAFT_TYPES`: список типов самолетов ["SA101", "SA102", "SA103"]
- `NUM_STATIONS = 5`: количество рабочих участков
- `MECHANICS_PER_STATION = 8`: количество механиков на участок
- `CYCLE_TIME_75 = 96`: время цикла для партии 75 самолетов (4 дня)
- `CYCLE_TIME_100 = 84`: время цикла для партии 100 самолетов (3.5 дня)
- `SHIFT_SCHEDULE`: график работы смен (первая и вторая смена, пн-пт)
- `OPERATIONS`: словарь всех операций (30 операций, по 6 на каждом участке)

**Функции:**
- `get_operations_by_station(station_id)`: возвращает операции для указанного участка
- `get_operations_by_sequence(station_id, sequence)`: возвращает операции определенной последовательности
- `get_total_processing_time(station_id, aircraft_type)`: вычисляет общее время обработки на участке

**Конфигурации партий:**
- `BATCH_75`: партия 75 самолетов (60% SA101, 40% SA102)
- `BATCH_100`: партия 100 самолетов (45% SA101, 30% SA102, 25% SA103)

### 2. Имитационная модель (`src/model.py`)

**Классы данных:**
- `Aircraft`: представляет самолет в системе
  - `id`: уникальный идентификатор
  - `aircraft_type`: тип самолета
  - `entry_time`: время входа в систему
  - `exit_time`: время выхода из системы
  - `station_times`: словарь времен обработки на каждом участке
  - `operations_completed`: список выполненных операций

- `StationStats`: статистика по рабочему участку
  - `utilization`: загрузка участка (0-1)
  - `blocking_time`: время блокировки
  - `idle_time`: время простоя
  - `total_processing_time`: общее время обработки
  - `aircraft_processed`: количество обработанных самолетов

- `ModelStats`: общая статистика модели
  - `cycle_times`: список времен между завершениями самолетов
  - `batch_completion_time`: время завершения всей партии
  - `wip_levels`: список уровней НЗП во времени
  - `station_stats`: статистика по каждому участку
  - `avg_wip`: средний уровень незавершенного производства

**Основной класс модели:**
- `AssemblyLineModel`: имитационная модель сборочной линии

  **Параметры инициализации:**
  - `buffer_capacity`: емкость буферов между участками (0, 1, или большое число)
  - `station_capacity`: количество самолетов, обрабатываемых одновременно (1 или 2)
  - `use_flexible_workforce`: использование единого пула рабочих (True/False)
  - `seed`: seed для генератора случайных чисел

  **Ресурсы SimPy:**
  - `stations`: ресурсы станций (участков) с заданной емкостью
  - `buffers`: буферы между станциями (Store с заданной емкостью или None)
  - `mechanics_pool` или `station_mechanics`: ресурсы механиков (единый пул или отдельные по участкам)

  **Основные методы:**
  - `aircraft_process(aircraft)`: процесс обработки самолета через все участки
  - `process_station_operations(aircraft, station_id)`: выполнение операций на участке с учетом последовательностей
  - `_execute_operation(...)`: выполнение одной операции с запросом механиков
  - `run_batch(...)`: запуск партии самолетов
  - `finalize_stats()`: финализация статистики после моделирования
  - `run(until)`: запуск моделирования

**Логика модели:**
1. Самолеты последовательно проходят через 5 участков
2. На каждом участке выполняются операции с учетом:
   - Последовательностей (Sequence) - операции одной последовательности выполняются параллельно
   - Предшественников - операция начинается только после завершения всех предшественников
   - Требований к рабочей силе - каждая операция запрашивает необходимое количество механиков
3. Буферы между участками управляют потоком самолетов
4. Собирается статистика по всем метрикам

### 3. Сценарии экспериментов (`src/scenarios.py`)

**Реализованные сценарии:**
1. **Сценарий 1**: Буферы отсутствуют (buffer_capacity=0, station_capacity=1)
2. **Сценарий 2**: Буфер 1 самолет (buffer_capacity=1, station_capacity=1)
3. **Сценарий 3**: Неограниченный буфер (buffer_capacity=1000, station_capacity=1)
4. **Сценарий 4**: Capacity 2, буферы отсутствуют (buffer_capacity=0, station_capacity=2)
5. **Сценарий 5**: Гибкая рабочая сила (buffer_capacity=0, station_capacity=1, use_flexible_workforce=True)

**Функции:**
- `get_scenario_1()` - `get_scenario_5()`: возвращают конфигурации сценариев
- `get_all_scenarios()`: возвращает список всех сценариев
- `get_batch_config(batch_type)`: конфигурация партии с фиксированным временем цикла
- `get_batch_config_no_cycle(batch_type)`: конфигурация партии без фиксированного времени цикла

### 4. Запуск экспериментов (`src/run_experiments.py`)

**Функции:**
- `run_single_experiment(...)`: запускает один эксперимент
  - Создает модель с параметрами сценария
  - Запускает партию самолетов
  - Собирает результаты
  - Возвращает словарь с метриками

- `run_experiment_series(...)`: запускает серию экспериментов
  - Для каждого сценария и конфигурации партии
  - Выполняет заданное количество репликаций
  - Сохраняет результаты в файлы (pickle и CSV)
  - Создает сводную таблицу

**Сохранение результатов:**
- Отдельные файлы для каждого эксперимента: `{scenario}_batch{batch_size}_rep{replication}.pkl`
- Сводная таблица: `results/summary.csv`
- Все результаты: `results/all_results.pkl`

**Собираемые метрики:**
- Время завершения партии
- Среднее время цикла
- Распределение времени цикла
- Средний уровень НЗП
- Загрузка каждого участка
- Время простоя и блокировки участков
- Детальная информация по каждому самолету

### 5. Анализ результатов (`src/analysis.py`)

**Функции загрузки данных:**
- `load_results(results_dir)`: загружает все результаты из pickle файла
- `load_summary(results_dir)`: загружает сводную таблицу из CSV
- `create_summary_from_results(results)`: создает сводную таблицу из списка результатов

**Функции анализа:**
- `calculate_statistics(df)`: вычисляет статистику (среднее, стандартное отклонение, min, max) по сценариям

**Функции визуализации:**
- `plot_batch_completion_time(df)`: график сравнения времени завершения партии
- `plot_cycle_time(df)`: boxplot времени цикла по сценариям
- `plot_station_utilization(df)`: графики загрузки каждого участка
- `plot_wip_levels(df)`: график уровня НЗП
- `plot_comparison_matrix(df)`: матрица сравнения всех метрик

**Функции отчетности:**
- `generate_report_table(df)`: генерирует таблицу статистики для отчета

Все графики сохраняются в `report/figures/` в формате PNG с высоким разрешением (300 DPI).

### 6. Тестовый скрипт (`test_model.py`)

Простой скрипт для быстрой проверки работы модели:
- Запускает небольшую партию (5 самолетов)
- Выводит основные метрики
- Позволяет проверить корректность работы модели перед запуском полных экспериментов

## Установка и настройка

### Требования

- Python 3.10+
- Зависимости указаны в `requirements.txt`:
  - `simpy>=4.0.1` - библиотека для дискретно-событийного моделирования
  - `numpy>=1.24.0` - численные вычисления
  - `pandas>=2.0.0` - обработка данных
  - `matplotlib>=3.7.0` - построение графиков
  - `seaborn>=0.12.0` - улучшенная визуализация

### Установка

```bash
# Клонирование репозитория (если используется git)
git clone <repository_url>
cd IMDP-SIM-AERO

# Создание виртуального окружения (рекомендуется)
python -m venv .venv
.venv\Scripts\activate  # Windows
# или
source .venv/bin/activate  # Linux/Mac

# Установка зависимостей
pip install -r requirements.txt
```

## Использование

### Быстрый тест модели

```bash
python test_model.py
```

Это запустит небольшой тест с 5 самолетами и выведет основные метрики.

### Запуск полных экспериментов

```bash
python -m src.run_experiments
```

Это выполнит:
- 5 сценариев
- 4 конфигурации партий (75 и 100 самолетов, с циклом и без)
- 5 репликаций для каждого эксперимента
- Всего: 5 × 4 × 5 = 100 экспериментов

**Время выполнения:** может занять от нескольких минут до часа в зависимости от мощности компьютера.

### Анализ результатов

```bash
python -m src.analysis
```

Это:
- Загрузит результаты из `results/`
- Вычислит статистику по сценариям
- Построит все графики
- Сохранит таблицы статистики

Графики будут сохранены в `report/figures/`, статистика - в `report/statistics.csv`.

## Параметры модели

### Производственная система

- **Количество участков**: 5 последовательно расположенных рабочих участков
- **Механиков на участок**: 8 человек (или единый пул 40 человек)
- **Типы самолетов**: 
  - SA101 (базовый)
  - SA102 (усложненный, времена на 10-15% больше)
  - SA103 (новый, времена как у SA101)

### Операции

- **Всего операций**: 30 (по 6 на каждом участке)
- **Последовательности**: операции группируются по последовательностям (1-5)
- **Параллельность**: операции одной последовательности выполняются параллельно
- **Времена выполнения**: от 0.5 до 8 часов в зависимости от операции и типа самолета
- **Требования к рабочей силе**: от 1 до 4 механиков на операцию

### Партии

- **Партия 75 самолетов**: 60% SA101, 40% SA102, время цикла 4 дня (96 часов)
- **Партия 100 самолетов**: 45% SA101, 30% SA102, 25% SA103, время цикла 3.5 дня (84 часа)

### Режимы работы

- **С фиксированным временем цикла**: самолеты запускаются с заданным интервалом
- **Без фиксированного времени цикла**: самолеты перемещаются только после завершения работ

## Метрики анализа

### Основные метрики

1. **Время цикла конвейера** (`cycle_time`)
   - Время между последовательными завершениями самолетов
   - Показывает производительность линии

2. **Время завершения партии** (`batch_completion_time`)
   - Общее время от начала до завершения обработки всей партии
   - Ключевой показатель эффективности

3. **Загрузка участков** (`utilization`)
   - Доля времени, в течение которого участок занят обработкой
   - Показывает эффективность использования ресурсов

4. **Незавершенное производство (НЗП)** (`avg_wip`)
   - Среднее количество самолетов в системе
   - Важно для управления затратами

5. **Время простоя и блокировки** (`idle_time`, `blocking_time`)
   - Показывает узкие места в системе

### Дополнительная статистика

- Среднее, стандартное отклонение, минимум, максимум для всех метрик
- Распределение времени цикла
- Детальная информация по каждому самолету

## Особенности реализации

### Дискретно-событийное моделирование

Модель использует библиотеку SimPy для дискретно-событийного моделирования:
- События: вход самолета, начало/конец обработки, выход самолета
- Ресурсы: станции, буферы, механики
- Процессы: обработка самолета, выполнение операций

### Управление ресурсами

- **Станции**: SimPy Resource с заданной емкостью (1 или 2 самолета)
- **Буферы**: SimPy Store с заданной емкостью (0, 1, или большое число)
- **Механики**: SimPy Resource (отдельные пулы по участкам или единый пул)

### Параллельное выполнение операций

Операции одной последовательности выполняются параллельно через запуск отдельных процессов SimPy. Время последовательности = максимальное время среди операций.

### Сбор статистики

Статистика собирается в реальном времени:
- При входе/выходе самолетов
- При начале/завершении обработки на участках
- При изменении уровня НЗП

## Ограничения и допущения

### Допущения модели

1. **Данные операций**: времена выполнения заданы на основе разумных допущений (Excel-файл не предоставлен)
2. **Рабочее время**: упрощенная модель (работа идет непрерывно, без учета смен и выходных)
3. **Детерминированные времена**: времена выполнения операций фиксированы (не стохастические)
4. **Нет поломок**: оборудование работает без сбоев
5. **Нет обучения**: все механики одинаково квалифицированы

### Возможные улучшения

1. Добавление стохастических времен выполнения (нормальное, экспоненциальное распределения)
2. Моделирование поломок оборудования и ремонтов
3. Детальное моделирование рабочего времени с учетом смен
4. Учет обучения работников и кривой обучения
5. Оптимизация конфигурации системы
6. Визуализация работы линии в реальном времени

## Результаты

После запуска экспериментов и анализа результаты доступны в:
- `results/summary.csv` - сводная таблица всех экспериментов
- `results/all_results.pkl` - полные данные всех экспериментов
- `report/figures/*.png` - графики сравнения метрик
- `report/statistics.csv` - статистика по сценариям

## Отчет

Полный текст курсовой работы находится в `report/report.md` и включает:
- Введение и постановку задачи
- Анализ предметной области
- Описание модели
- Результаты экспериментов
- Анализ и выводы
- Список литературы

## Автор

[Ваше ФИО]  
[Ваша группа]

## Лицензия

Образовательный проект.

---

## Дополнительная информация

### Структура операций по участкам

**Участок 1: Подготовка корпуса**
- Установка опорных конструкций
- Проверка геометрии корпуса
- Подготовка крепежных элементов
- Установка внутренних перегородок
- Монтаж систем крепления
- Проверка качества сборки

**Участок 2: Установка систем**
- Прокладка электрических кабелей
- Установка гидравлических систем
- Монтаж систем кондиционирования
- Подключение систем к центральным узлам
- Тестирование систем
- Документирование установки

**Участок 3: Установка интерьера**
- Установка пассажирских кресел
- Монтаж багажных полок
- Установка освещения салона
- Монтаж кухонного оборудования
- Установка туалетных модулей
- Финишная отделка интерьера

**Участок 4: Установка двигателей и крыльев**
- Подготовка точек крепления двигателей
- Установка двигателей
- Подключение топливных систем
- Установка крыльев
- Подключение систем управления
- Проверка силовой установки

**Участок 5: Финальная сборка и испытания**
- Установка шасси
- Монтаж навигационного оборудования
- Установка систем связи
- Покраска и маркировка
- Комплексные испытания
- Финальная проверка и сертификация

### Примеры использования

**Создание модели:**
```python
from src.model import AssemblyLineModel

model = AssemblyLineModel(
    buffer_capacity=1,
    station_capacity=1,
    use_flexible_workforce=False,
    seed=42
)
```

**Запуск партии:**
```python
model.env.process(
    model.run_batch(
        batch_size=75,
        aircraft_distribution={"SA101": 0.6, "SA102": 0.4},
        cycle_time=96,
        use_cycle_time=True
    )
)
model.run()
```

**Доступ к результатам:**
```python
print(f"Время завершения: {model.stats.batch_completion_time}")
print(f"Средний НЗП: {model.stats.avg_wip}")
for station_id in range(1, 6):
    print(f"Участок {station_id}: {model.stats.station_stats[station_id].utilization:.2%}")
```
